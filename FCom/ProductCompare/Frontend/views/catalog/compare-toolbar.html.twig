{% set compare = APP.instance('FCom_ProductCompare_Model_Set').sessionSet().getCompareProductsDetailsJson(1) %}

<div class="f-widget f-widget-prods-compare">
    <form method="post" action="{{ APP.href('catalog/compare') }}">
      <strong class="f-widget-title">{{ 'Compare up to 5 products'|_ }}</strong>
      <ul class="f-widget-content">
        <li class="item"></li>
        <li class="item"></li>
        <li class="item"></li>
        <li class="item"></li>
        <li class="item"></li>
      </ul>
      <button type="submit" class="btn btn-default btn-sm" id="compare-trigger" rel="#compare-overlay" value="compare"><span>{{ "Compare" |_ }}</span></button>
      <button type="submit" class="btn btn-default btn-sm reset-btn" value="reset">{{ 'Reset' |_ }}</button>
    </form>
</div>
<!-- /.f-widget-prods-compare -->

<div class="overlay" id="compare-overlay"><div class="contentWrap"></div></div>
<script>
require(['jquery', 'fcom.productcompare'], function($) {
    var compare = {{ compare | raw }};
    $(function() { // let all checkboxes to load first
        $('.block-compare').data('compare', new FCom.CompareBlock({
            thumbContainer: '.f-widget-prods-compare',
            checkbox: '.btn-compare',
            img: '.f-prod-img',
            productIds: compare,
            url_add: '{{ APP.href('catalog/compare/addxhr') }}',
            url_remove: '{{ APP.href('catalog/compare/rmxhr') }}'
        }));
/*
        $("#compare-trigger").overlay({
            mask: { color:'#000', loadSpeed:0, opacity:0.3 },
            effect:'default',
            speed:0,
            onBeforeLoad: function() {
                this.getOverlay().find(".contentWrap").load(this.getTrigger().attr("href"));
            }
        });
*/
    });
})
</script>
